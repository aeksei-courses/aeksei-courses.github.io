
        <!DOCTYPE html>
        <html lang="ru" dir="ltr">
            <head>
                <meta charset="utf-8">
                
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Основные типы полей и их особенности | django-web-api</title>
                <style type="text/css">
                    body {
                        height: 100vh;
                    }
                </style>
                <link type="text/css" rel="stylesheet" href="../../../_bundle/vendor.css" />
<link type="text/css" rel="stylesheet" href="../../../_bundle/app.css" />
                
                
            </head>
            <body class="g-root g-root_theme_light">
                <div id="root"></div>
                <script type="application/javascript">
                   window.STATIC_CONTENT = false
                   window.__DATA__ = {"data":{"leading":false,"toc":{"title":"django-web-api","href":"../../../index.html","items":[{"name":"Введение в курс","href":"../../../course.html","id":"Введение в курс-0-0.23304645228180587"},{"name":"Основы ORM в Django","items":[{"name":"Введение в курс","href":"../../../Основы ORM в Django/section.html","id":"Введение в курс-0-0.5225607571487003"},{"name":"ORM модели","items":[{"name":"Введение в модели Django","href":"../../../Основы ORM в Django/ORM модели/Введение в модели Django/task.html","id":"Введение в модели Django-0-0.7463100550979016"},{"name":"Работа с миграциями данных","href":"../../../Основы ORM в Django/ORM модели/Работа с миграциями данных/task.html","id":"Работа с миграциями данных-1-0.506468828725996"},{"name":"Хорошие практики по работе с миграциями","href":"../../../Основы ORM в Django/ORM модели/Хорошие практики по работе с миграциями/task.html","id":"Хорошие практики по работе с миграциями-2-0.17270136746796005"},{"name":"Основные типы полей и их особенности","href":"../../../Основы ORM в Django/ORM модели/Основные типы полей и их особенности/task.html","id":"Основные типы полей и их особенности-3-0.07620307713572627"},{"name":"Добавление данных через фикстуры","href":"../../../Основы ORM в Django/ORM модели/Добавление данных через фикстуры/task.html","id":"Добавление данных через фикстуры-4-0.1772033064208829"}],"id":"ORM модели-1-0.9378925052610485"},{"name":"CRUD операции","items":[{"name":"Чтение данных","href":"../../../Основы ORM в Django/CRUD операции/Чтение данных/task.html","id":"Чтение данных-0-0.3111575178175119"},{"name":"Создание и обновление объектов","href":"../../../Основы ORM в Django/CRUD операции/Создание и обновление объектов/task.html","id":"Создание и обновление объектов-1-0.06135945639158136"},{"name":"Удаление объектов","href":"../../../Основы ORM в Django/CRUD операции/Удаление объектов/task.html","id":"Удаление объектов-2-0.1429541579086686"}],"id":"CRUD операции-2-0.5386948567919398"},{"name":"Работа с админкой","items":[{"name":"Основы работы с админкой","href":"../../../Основы ORM в Django/Работа с админкой/Основы работы с админкой/task.html","id":"Основы работы с админкой-0-0.9349976500706134"},{"name":"Настройка отображения экземпляров моделей в админ панели","href":"../../../Основы ORM в Django/Работа с админкой/Настройка отображения экземпляров моделей в админ панели/task.html","id":"Настройка отображения экземпляров моделей в админ панели-1-0.9092840119303023"},{"name":"Основы работы с админкой","href":"../../../Основы ORM в Django/Работа с админкой/Дополнительные настройки админки/task.html","id":"Основы работы с админкой-2-0.1479286114998961"}],"id":"Работа с админкой-3-0.28614129905858743"}],"id":"Основы ORM в Django-1-0.9042699835551935"}],"base":"."},"meta":{"metadata":[],"style":[],"script":[]},"assets":[],"headings":[{"title":"Цель урока","href":"#cel-uroka","level":2},{"title":"Типы полей","href":"#tipy-polej","level":2,"items":[{"title":"Ограничения в названиях полей","href":"#ogranicheniya-v-nazvaniyah-polej","level":3},{"title":"Основные типы полей","href":"#osnovnye-tipy-polej","level":3}]},{"title":"Конфигурация полей: опции и настройки","href":"#konfiguraciya-polej-opcii-i-nastrojki","level":2,"items":[{"title":"Параметр primary_key","href":"#parametr","level":3},{"title":"Обязательные и необязательные поля","href":"#obyazatelnye-i-neobyazatelnye-polya","level":3}]},{"title":"Поля с вариантами выбора","href":"#polya-s-variantami-vybora","level":2,"items":[{"title":"Параметр choices","href":"#parametr1","level":3},{"title":"Использование класса TextChoice","href":"#ispolzovanie-klassa","level":3}]},{"title":"Поля с временем и датой","href":"#polya-s-vremenem-i-datoj","level":2,"items":[{"title":"Параметры auto_now и **auto_now_add**","href":"#i","level":3}]},{"title":"Уникальные поля","href":"#unikalnye-polya","level":2,"items":[{"title":"Поле SlugField для \"человеко-читаемых\" идентификаторов","href":"#dlya-cheloveko-chitaemyh-identifikatorov","level":3}]},{"title":"Важность проектирования схемы БД","href":"#vazhnost-proektirovaniya-shemy-bd","level":2,"items":[{"title":"Рекомендации по действиям","href":"#rekomendacii-po-dejstviyam","level":3}]}],"title":"Основные типы полей и их особенности","includes":[],"html":"<h2 id=\"cel-uroka\"><a href=\"#cel-uroka\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Цель урока</span></a>Цель урока</h2>\n<p>В этом уроке вы изучите различные типы полей, доступные в Django ORM, их особенности, а также научитесь конфигурировать поля с помощью различных параметров и опций. Вы рассмотрите, как правильно выбирать типы полей для различных данных, которые вы хотите хранить в вашей базе данных, и как использование определенных настроек может влиять на поведение полей в моделях Django. Также будет рассмотрено, какие ограничения существуют при наименовании полей и как эти ограничения могут влиять на разработку вашего приложения.</p>\n<h2 id=\"tipy-polej\"><a href=\"#tipy-polej\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Типы полей</span></a>Типы полей</h2>\n<p>Django ORM предлагает гибкий способ работы с базами данных, позволяя разработчикам определять структуру данных своих приложений на уровне Python кода. Один из ключевых аспектов работы с Django ORM - это выбор правильных типов полей для моделей.</p>\n<h3 id=\"ogranicheniya-v-nazvaniyah-polej\"><a href=\"#ogranicheniya-v-nazvaniyah-polej\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Ограничения в названиях полей</span></a>Ограничения в названиях полей</h3>\n<p>При выборе имен для полей ваших моделей Django, важно избегать использования определенных слов и символов, чтобы предотвратить конфликты или ошибки в коде.</p>\n<ul>\n<li>\n<p><strong>Двойные подчеркивания</strong>: В Django, двойные подчеркивания используются в запросах ORM для фильтрации и поиска. Их использование в именах полей может привести к неожиданным ошибкам.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># Неправильное использование двойных подчеркиваний в имени поля</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ExampleModel</span>(models.Model):\n    name__startswith = models.CharField(max_length=<span class=\"hljs-number\">50</span>)  <span class=\"hljs-comment\"># Может вызвать ошибку</span>\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"23\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-23\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-23\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-23.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n</li>\n<li>\n<p><strong>Подчеркивания в конце</strong>: Django добавляет подчеркивания к некоторым внутренним атрибутам модели, так что их использование в конце имени поля может вызвать конфликты имен.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># Неправильное использование подчеркивания в конце имени поля</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ExampleModel</span>(models.Model):\n    name_ = models.CharField(max_length=<span class=\"hljs-number\">50</span>)  <span class=\"hljs-comment\"># Может вызвать конфликт имен</span>\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"29\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-29\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-29\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-29.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n</li>\n<li>\n<p><strong>Ключевые слова в Python</strong>: Использование ключевых слов Python, таких как <code>class</code>, <code>def</code>, <code>return</code>, в качестве имен полей может привести к синтаксическим ошибкам или неожиданному поведению программы.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># Неправильное использование ключевого слова Python в качестве имени поля</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    <span class=\"hljs-keyword\">def</span> = models.CharField(max_length=<span class=\"hljs-number\">100</span>)  <span class=\"hljs-comment\"># Недопустимо, вызовет синтаксическую ошибку</span>\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"35\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-35\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-35\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-35.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n</li>\n</ul>\n<h3 id=\"osnovnye-tipy-polej\"><a href=\"#osnovnye-tipy-polej\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Основные типы полей</span></a>Основные типы полей</h3>\n<p>Для удобства представим основные типы полей в виде таблицы:</p>\n<table>\n<thead>\n<tr>\n<th>Тип поля</th>\n<th>Описание</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CharField</td>\n<td>Предназначен для коротких строк текста, требует указания max_length. Используется для имен, заголовков и других коротких текстовых данных.</td>\n</tr>\n<tr>\n<td>TextField</td>\n<td>Используется для длинного текста без ограничения по длине. Подходит для статей, описаний и других объемных текстов.</td>\n</tr>\n<tr>\n<td>IntegerField</td>\n<td>Представляет целые числа. Идеален для возраста, количественных данных и других числовых значений без дробных частей.</td>\n</tr>\n<tr>\n<td>BooleanField</td>\n<td>Хранит логическое значение (True или False), подходит для флагов, статусов и других бинарных признаков.</td>\n</tr>\n<tr>\n<td>FloatField</td>\n<td>Представляет числа с плавающей точкой. Используется для хранения чисел, требующих дробных значений, например, веса, расстояния и других измерений.</td>\n</tr>\n<tr>\n<td>DateField</td>\n<td>Для хранения даты (год, месяц, день).</td>\n</tr>\n<tr>\n<td>DateTimeField</td>\n<td>Хранит дату и время, часто используется для отметок времени создания или последнего изменения записи.</td>\n</tr>\n<tr>\n<td>SlugField</td>\n<td>Используется для коротких меток или идентификаторов страниц, содержащих только буквы, цифры, подчеркивания или дефисы. Используется в URL-адресах для SEO-оптимизации.</td>\n</tr>\n</tbody>\n</table>\n<aside>\nℹ️ URL, использующий slug для идентификации страницы или ресурса, выглядит как `https://example.com/books/my-book-title`, где `my-book-title` является примером slug, обеспечивающим читаемые и оптимизированные для поисковых систем адреса страниц. [Статья](https://sky.pro/wiki/javascript/slug-v-url-kak-sozdat-i-ispolzovat-dlya-seo-i-ux/) для ознакомления.\n</aside>\n<h2 id=\"konfiguraciya-polej-opcii-i-nastrojki\"><a href=\"#konfiguraciya-polej-opcii-i-nastrojki\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Конфигурация полей: опции и настройки</span></a>Конфигурация полей: опции и настройки</h2>\n<p>Рассмотрим, как можно настроить поведение полей в моделях Django с помощью различных параметров. Правильная конфигурация полей позволяет не только уточнить, как данные должны быть представлены и обработаны, но и управлять такими аспектами, как валидация, базовые значения и индексация в базе данных.</p>\n<h3 id=\"parametr\"><a href=\"#parametr\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Параметр </span></a>Параметр <code>primary_key</code></h3>\n<p>По умолчанию Django <a href=\"https://docs.djangoproject.com/en/4.2/topics/db/models/#automatic-primary-key-fields\" target=\"_blank\" rel=\"noreferrer noopener\">автоматически</a> добавляет поле <code>id</code> в качестве первичного ключа (PK) для каждой модели.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-built_in\">id</span> = models.BigAutoField(primary_key=<span class=\"hljs-literal\">True</span>)\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"136\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-136\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-136\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-136.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>Но вы можете явно указать другое поле как PK с помощью параметра <code>primary_key=True</code></p>\n<aside>\n⚠️ В модели может быть только одно поле с параметром `primary_key=True` (или указанным явно или автоматически)\n</aside>\n<h3 id=\"obyazatelnye-i-neobyazatelnye-polya\"><a href=\"#obyazatelnye-i-neobyazatelnye-polya\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Обязательные и необязательные поля</span></a>Обязательные и необязательные поля</h3>\n<p>В Django, все поля моделей по умолчанию являются обязательными, что означает, что для них автоматически устанавливаются параметры <code>null=False</code> и <code>blank=False</code>. Это значит, что при попытке сохранить модель без указания значений для этих полей, Django выдаст ошибку.</p>\n<ul>\n<li><code>null</code> определяет, может ли поле содержать <code>NULL</code> в базе данных, что критично для полей, которые могут логически принимать \"нет значения\".</li>\n<li><code>blank</code> определяет, может ли поле быть пустым на уровне Django форм. Это влияет на валидацию данных в формах и админ-панели.</li>\n</ul>\n<p>Рассмотрим модель <code>Book</code>, где поле <code>year</code> сделаем не обязательным:</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># books/models.py</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    title = models.CharField(max_length=<span class=\"hljs-number\">100</span>)  <span class=\"hljs-comment\"># Обязательное поле</span>\n    year = models.SmallIntegerField(null=<span class=\"hljs-literal\">True</span>, blank=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># Необязательное поле, может быть null</span>\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"163\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-163\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-163\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-163.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>В этом случае, поле <code>year</code> может быть оставлено без значения, что может быть интерпретировано как \"год издания неизвестен\". При создании миграций не будет никаких проблем, так как обязательное поле стало не обязательным.</p>\n<p>При добавлении нового поля, такого как <code>description = models.TextField()</code> в существующую модель, и попытке создать миграцию командой <code>makemigrations</code> выдаст ошибку.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># books/models.py</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    title = models.CharField(max_length=<span class=\"hljs-number\">100</span>)\n    year = models.SmallIntegerField(null=<span class=\"hljs-literal\">True</span>, blank=<span class=\"hljs-literal\">True</span>)\n    description = models.TextField()  <span class=\"hljs-comment\"># Добавлено новое обязательное поле</span>\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"170\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-170\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-170\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-170.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs\">It is impossible to add a non-nullable field 'description' to book without specifying a default. This is because the database needs something to populate existing rows.\nPlease select a fix:\n 1) Provide a one-off default now (will be set on all existing rows with a null value for this column)\n 2) Quit and manually define a default value in models.py.\nSelect an option:\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"171\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-171\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-171\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-171.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>Эта ошибка указывает на проблему при добавлении нового поля в базу данных без указания значения по умолчанию. В данном случае, поле <code>description</code> не может быть добавлено к модели <code>Book</code> без указания значения по умолчанию, потому что база данных требует значение для заполнения существующих строк.</p>\n<p>Даже если в БД сейчас нет записей нельзя гарантировать, что при выполнении этих миграций на других БД, там тоже не будет записей.</p>\n<p>Предложенные варианты решения:</p>\n<ol>\n<li>Предоставить значение по умолчанию сейчас. Это значение будет установлено для всех существующих строк, у которых значение для этого поля равно NULL.</li>\n<li>Прекратить выполнение операции и вручную определить значение по умолчанию в файле <code>models.py</code>.</li>\n</ol>\n<p>Выбор опции зависит от вашего конкретного случая и требований вашего приложения.</p>\n<p>Выберем второй вариант и установим значение по умолчанию прямо в модели. Чтобы решить эту проблему, вы можете:</p>\n<ul>\n<li>Указать <code>null=True</code>, если для логики вашего приложения допустимо иметь <code>NULL</code> в этом поле.</li>\n<li>Указать <code>default=\"\"</code> для поля, что установит пустую строку в качестве значения по умолчанию для всех существующих и новых записей.</li>\n</ul>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># books/models.py</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    title = models.CharField(max_length=<span class=\"hljs-number\">100</span>)\n    year = models.SmallIntegerField(null=<span class=\"hljs-literal\">True</span>, blank=<span class=\"hljs-literal\">True</span>)\n    description = models.TextField(default=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># Установлено значение по умолчанию</span>\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"211\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-211\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-211\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-211.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<aside>\n💡 Использование `default=\"\"` для текстовых полей предпочтительнее `null=True` по нескольким причинам:\n<ul>\n<li>Это упрощает работу с полем на уровне Python кода, так как вы можете ожидать строку в любом случае и избегать проверок на <code>None</code>.</li>\n<li>Согласованность данных: в базе данных не будет различия между отсутствием значения и пустой строкой, что облегчает фильтрацию и агрегацию.</li>\n<li>В Django принято использовать пустые строки для текстовых полей, чтобы избежать смешивания двух возможных \"отсутствующих\" значений (<code>None</code> и пустая строка).</li>\n</ul>\n</aside>\n<h2 id=\"polya-s-variantami-vybora\"><a href=\"#polya-s-variantami-vybora\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Поля с вариантами выбора</span></a>Поля с вариантами выбора</h2>\n<p>В моделях Django вы можете ограничить значения, которые может принимать поле, используя параметр <code>choices</code>. Это очень полезно, когда у вас есть определенный набор возможных значений для поля, и вы хотите гарантировать, что в базу данных будут введены только допустимые значения.</p>\n<h3 id=\"parametr1\"><a href=\"#parametr1\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Параметр </span></a>Параметр <code>choices</code></h3>\n<p>Параметр <code>choices</code> принимает итерируемый объект (например, список или кортеж), состоящий из пар \"значение, человекочитаемое название\". Это позволяет вам не только ограничить значения поля, но и предоставить более понятные названия для отображения в пользовательских интерфейсах.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    <span class=\"hljs-comment\"># Определение констант для типов книг</span>\n    HARDCOVER = <span class=\"hljs-string\">'HC'</span>  <span class=\"hljs-comment\"># Твердая обложка</span>\n    PAPERBACK = <span class=\"hljs-string\">'PB'</span>  <span class=\"hljs-comment\"># Мягкая обложка</span>\n    EBOOK = <span class=\"hljs-string\">'EB'</span>  <span class=\"hljs-comment\"># Электронная книга</span>\n    \n    <span class=\"hljs-comment\"># Список кортежей, представляющих доступные типы книг</span>\n    BOOK_TYPES = [  <span class=\"hljs-comment\"># (значение, отображаемая строка)</span>\n        (HARDCOVER, <span class=\"hljs-string\">'Твердая обложка'</span>),  \n        (PAPERBACK, <span class=\"hljs-string\">'Мягкая обложка'</span>),\n        (EBOOK, <span class=\"hljs-string\">'Электронная книга'</span>),\n    ]\n    \n    ...\n    \n    <span class=\"hljs-comment\"># Поле для хранения типа книги, с выбором из заранее определенных значений</span>\n    book_type = models.CharField(\n        max_length=<span class=\"hljs-number\">2</span>,\n        choices=BOOK_TYPES,  <span class=\"hljs-comment\"># Доступные типы книг</span>\n        default=PAPERBACK,  <span class=\"hljs-comment\"># Значение по умолчанию: Мягкая обложка</span>\n    )\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"243\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-243\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-243\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-243.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>Поле <code>book_type</code> представляет собой тип книги и будет храниться в базе данных в виде короткого кода, такого как <code>HC</code> (твердая обложка), <code>PB</code> (мягкая обложка) или <code>EB</code> (электронная книга). Однако, для удобства пользователя, при отображении пользовательского интерфейса, значения в поле <code>book_type</code> будут отображаться в более понятной форме: <code>\"Твердая обложка\"</code>, \"Мягкая обложка\" и \"Электронная книга\".</p>\n<h3 id=\"ispolzovanie-klassa\"><a href=\"#ispolzovanie-klassa\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Использование класса </span></a>Использование класса <code>TextChoice</code></h3>\n<p>Для улучшения читаемости и удобства использования, Django позволяет определять <code>choices</code> как классы <code>models.TextChoices</code>. Это также позволяет использовать их значения как константы в вашем коде.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    <span class=\"hljs-comment\"># Определение класса BookType, использующегося для выбора типа книги</span>\n    <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BookType</span>(models.TextChoices):\n        <span class=\"hljs-comment\"># Определение констант для различных типов книг с их отображаемыми значениями</span>\n        HARDCOVER = <span class=\"hljs-string\">'HC'</span>, <span class=\"hljs-string\">'Твердая обложка'</span>\n        PAPERBACK = <span class=\"hljs-string\">'PB'</span>, <span class=\"hljs-string\">'Мягкая обложка'</span>\n        EBOOK = <span class=\"hljs-string\">'EB'</span>, <span class=\"hljs-string\">'Электронная книга'</span>\n    \n    ...\n    <span class=\"hljs-comment\"># Поле для хранения типа книги, с выбором из значений, определенных в BookType</span>\n    book_type = models.CharField(\n        max_length=<span class=\"hljs-number\">2</span>,\n        choices=BookType.choices,  <span class=\"hljs-comment\"># Доступные типы книг</span>\n        default=BookType.PAPERBACK  <span class=\"hljs-comment\"># Значение по умолчанию: Paperback</span>\n    )\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"253\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-253\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-253\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-253.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>Вложенный класс <code>BookType</code>, используется для выбора типа книги. Каждый тип книги представлен в виде константы с двумя значениями: кодом (например, <code>HC</code>) и соответствующим ему отображаемым значением (например, <code>\"Твердая обложка\"</code>).</p>\n<p>Класс <code>BookType</code> содержит атрибут <code>choices</code>, который представляет собой список кортежей, каждый из которых содержит два значения: значение поля и соответствующее ему отображаемое значение.</p>\n<h2 id=\"polya-s-vremenem-i-datoj\"><a href=\"#polya-s-vremenem-i-datoj\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Поля с временем и датой</span></a>Поля с временем и датой</h2>\n<p>В Django для работы с датами и временем предусмотрены специальные типы полей, позволяющие легко сохранять, извлекать и обрабатывать даты и временные метки в ваших моделях.</p>\n<ul>\n<li><code>DateField</code> предназначен для хранения даты без времени (год, месяц, день).</li>\n<li><code>DateTimeField</code> используется для хранения даты вместе с временем.</li>\n</ul>\n<p>Оба поля могут быть настроены с использованием различных параметров, чтобы автоматически устанавливать даты при создании или обновлении записей.</p>\n<h3 id=\"i\"><a href=\"#i\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\"> и </span></a>Параметры <code>auto_now</code> и <code>**auto_now_add**</code></h3>\n<ul>\n<li><code>auto_now</code> при каждом сохранении объекта обновляет поле даты/времени на текущее значение.</li>\n<li><code>auto_now_add</code> устанавливает дату/время при создании объекта на текущее значение и больше не обновляется автоматически.</li>\n</ul>\n<p>Различие между ними заключается в том, что <code>auto_now</code> используется для полей, которые должны всегда отражать время последнего изменения объекта, в то время как <code>auto_now_add</code> предназначен для фиксации времени создания объекта.</p>\n<p>Добавление полей <code>created_at</code> и <code>updated_at</code> к модели <code>Book</code> позволяет отслеживать время создания и последнего изменения каждой записи. Это особенно полезно для ведения истории изменений.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-comment\"># books/models.py</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    ...\n    created_at = models.DateTimeField(auto_now_add=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># автоматически устанавливается при создании</span>\n    updated_at = models.DateTimeField(auto_now=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># автоматически обновляется при каждом сохранении</span>\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"302\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-302\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-302\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-302.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>В этой модели <code>created_at</code> будет автоматически установлен при первом сохранении объекта <code>Book</code>, а <code>updated_at</code> - при каждом его сохранении, предоставляя точные временные метки для отслеживания жизненного цикла объекта.</p>\n<p>При попытке создания миграции, будет следующее предупреждение</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs\">It is impossible to add the field 'created_at' with 'auto_now_add=True' to book without providing a default. This is because the database needs something to populate existing rows.\n 1) Provide a one-off default now which will be set on all existing rows\n 2) Quit and manually define a default value in models.py.\nSelect an option: 1\nPlease enter the default value as valid Python.\nAccept the default 'timezone.now' by pressing 'Enter' or provide another value.\nThe datetime and django.utils.timezone modules are available, so it is possible to provide e.g. timezone.now as a value.\nType 'exit' to exit this prompt\n[default: timezone.now] &gt;&gt;&gt;\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"309\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-309\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-309\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-309.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>Это сообщение связано с попыткой добавить поле <code>created_at</code> с параметром <code>auto_now_add=True</code> в модель <code>Book</code>, но без предоставления значения по умолчанию.</p>\n<p>Однако, в данном случае, поскольку уже могут существовать записи в базе данных, Django не может просто добавить новое поле без указания значения по умолчанию для существующих строк.</p>\n<p>В сообщении предлагается два варианта решения проблемы:</p>\n<ol>\n<li>Предоставить одноразовое значение по умолчанию, которое будет установлено для всех существующих строк.</li>\n<li>Прекратить выполнение операции и вручную определить значение по умолчанию в файле <code>models.py</code>.</li>\n</ol>\n<p>Выбрав первый вариант, вам предложат ввести значение по умолчанию. По умолчанию предлагается использовать функцию <code>timezone.now</code> из модуля <code>django.utils.timezone</code> для установки текущего времени. Вы также можете ввести другое значение или оставить значение по умолчанию, нажав 'Enter'.</p>\n<h2 id=\"unikalnye-polya\"><a href=\"#unikalnye-polya\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Уникальные поля</span></a>Уникальные поля</h2>\n<p>Уникальность данных является важной частью проектирования баз данных, гарантируя, что в определенных полях не будут дублироваться значения. Django предоставляет механизмы для обеспечения уникальности полей в моделях через использование параметра <code>unique</code>.</p>\n<p>Когда параметр <code>unique</code> установлен в <code>True</code> для поля модели, Django гарантирует, что в таблице базы данных для этого поля не будет двух записей с одинаковыми значениями. Это особенно полезно для данных, которые должны быть уникальными на всю таблицу, например, адреса электронной почты, идентификаторы пользователей или URL-адреса.</p>\n<h3 id=\"dlya-cheloveko-chitaemyh-identifikatorov\"><a href=\"#dlya-cheloveko-chitaemyh-identifikatorov\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\"> для \"человеко-читаемых\" идентификаторов</span></a>Поле <code>SlugField</code> для \"человеко-читаемых\" идентификаторов</h3>\n<p><code>SlugField</code> обычно используется для хранения \"человеко-читаемых\" идентификаторов объектов, которые могут использоваться в URL-адресах. Установка <code>unique=True</code> для <code>SlugField</code> гарантирует, что каждый slug уникален в пределах таблицы, что идеально подходит для создания SEO-дружественных URL.</p>\n\n    <div class=\"yfm-clipboard\">\n    <pre><code class=\"hljs python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Book</span>(models.Model):\n    ...\n    slug = models.SlugField(max_length=<span class=\"hljs-number\">100</span>, unique=<span class=\"hljs-literal\">True</span>)\n\n</code></pre>\n\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" class=\"yfm-clipboard-button\" data-animation=\"349\">\n        <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path>\n        <path stroke=\"currentColor\" fill=\"transparent\" stroke-width=\"1.5\" d=\"M9.5 13l3 3l5 -5\" visibility=\"hidden\">\n            <animate id=\"visibileAnimation-349\" attributeName=\"visibility\" from=\"hidden\" to=\"visible\" dur=\"0.2s\" fill=\"freeze\" begin></animate>\n            <animate id=\"hideAnimation-349\" attributeName=\"visibility\" from=\"visible\" to=\"hidden\" dur=\"1s\" begin=\"visibileAnimation-349.end+1\" fill=\"freeze\"></animate>\n        </path>\n    </svg>\n    </div>\n<p>В этой модификации модели <code>Book</code> добавлено поле <code>slug</code>, которое предназначено для использования в качестве части URL, ведущего к странице книги. Установка <code>unique=True</code> гарантирует, что каждый слаг в таблице книг уникален, что предотвращает возможность создания двух книг с одинаковым URL.</p>\n<p>Это позволяет эффективно организовать структуру URL вашего веб-приложения, обеспечивая удобство навигации и оптимизацию для поисковых систем. Каждая книга может быть легко идентифицирована и доступна по уникальному пути, что улучшает пользовательский опыт и способствует лучшему индексированию страниц.</p>\n<h2 id=\"vazhnost-proektirovaniya-shemy-bd\"><a href=\"#vazhnost-proektirovaniya-shemy-bd\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Важность проектирования схемы БД</span></a>Важность проектирования схемы БД</h2>\n<p>При разработке и расширении ваших приложений на Django вы можете столкнуться с необходимостью добавления новых полей в существующие модели. Хотя Django делает процесс миграции относительно простым, есть случаи, когда добавление нового поля не может быть выполнено без явного указания значения по умолчанию или дополнительных действий. Это особенно актуально для полей с ограничениями уникальности, таких как <code>SlugField</code>, где нельзя просто применить одно и то же значение по умолчанию ко всем записям.</p>\n<p>Решение этой проблемы может потребовать более сложных действий, таких как написание кастомных скриптов миграции, которые генерируют уникальные значения для каждой существующей записи. Такой подход, выходит за рамки текущего курса.</p>\n<h3 id=\"rekomendacii-po-dejstviyam\"><a href=\"#rekomendacii-po-dejstviyam\" class=\"yfm-anchor\" aria-hidden=\"true\"><span class=\"visually-hidden\">Рекомендации по действиям</span></a>Рекомендации по действиям</h3>\n<p>В учебных или тестовых целях, когда вы сталкиваетесь с подобной ситуацией и в вашей базе данных нет критически важной информации, или вы готовы потерять существующие данные, простейшее решение — это откат миграций до момента создания таблицы, удаление миграций и создание их с нуля. Это обеспечит корректное добавление новых полей с учетом всех ограничений и зависимостей.</p>\n<p>Однако, на практике, особенно в рабочих проектах, где потеря данных неприемлема, крайне важно заранее тщательно планировать структуру базы данных и изменения, которые могут потребоваться в будущем. Это поможет избежать сложностей с миграциями и сохранить целостность и доступность данных.</p>\n"},"router":{"pathname":"../../../Основы ORM в Django/ORM модели/Основные типы полей и их особенности/task.html"},"lang":"ru"};
                </script>
                <script type="application/javascript" src="../../../_bundle/react.js"></script>
<script type="application/javascript" src="../../../_bundle/app.js"></script>
<script type="application/javascript" src="../../../_bundle/vendor.js"></script>
            </body>
        </html>
    